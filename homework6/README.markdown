# README.md

## –û–ø–∏—Å–∞–Ω–∏–µ –¥–æ–º–∞—à–Ω–µ–π —Ä–∞–±–æ—Ç—ã

–î–∞–Ω–Ω–∞—è –¥–æ–º–∞—à–Ω—è—è —Ä–∞–±–æ—Ç–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∑–∞–¥–∞—á—É –ø–æ —É–ª—É—á—à–µ–Ω–∏—é –º–æ–¥–µ–ª–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, –æ–±—É—á–∞–µ–º–æ–π –Ω–∞ —Ç–µ–∫—Å—Ç–µ –∫–Ω–∏–≥–∏ "–ì–∞—Ä—Ä–∏ –ü–æ—Ç—Ç–µ—Ä –∏ –û—Ä–¥–µ–Ω –§–µ–Ω–∏–∫—Å–∞" –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ. –¶–µ–ª—å ‚Äî —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–æ–≤ –¥–ª—è —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞, –æ–±—É—á–µ–Ω–∏—è –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞. –†–∞–±–æ—Ç–∞ –≤–∫–ª—é—á–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥—É–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫–æ–¥–∞ –∏ —É–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Python –∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (PyTorch, PyTorch Lightning –∏ –¥—Ä.).
2. –°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é —Å—Ä–µ–¥—É –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –µ—ë:
   ```
   python -m venv env
   env\Scripts\activate
   ```
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
   ```
   pip install pytorch-lightning torch
   ```
   –î–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ TensorBoard:
   ```
   pip install lightning[extra]
   ```
   –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –æ–±–ª–∞—á–Ω—ã–º–∏ –∑–∞–≥—Ä—É–∑–∫–∞–º–∏:
   ```
   pip install litmodels
   ```

## –§–∞–π–ª—ã –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–æ–º–∞—à–Ω–µ–π —Ä–∞–±–æ—Ç—ã

- `tokenizer.json` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Byte-Level BPE.
- `data.py` - –º–æ–¥—É–ª—å –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö.
- `model.py` - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–∞.
- `train.py` - —Å–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏.
- `generate.py` - —Å–∫—Ä–∏–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞.

## –ü—Ä–∏–º–µ—Ä –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
–ó–∞–ø—É—Å—Ç–∏—Ç–µ `train.py`:
```
PS C:\Users\79022\Desktop\SummerParty\homework6> & C:/Users/79022/Desktop/SummerParty/homework6/env/Scripts/python.exe c:/Users/79022/Desktop/SummerParty/homework6/train.py
[00:00:00] –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤ (0 –ú–æ)    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà                100%
[00:00:00] –¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è —Å–ª–æ–≤               ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà 15166    /    15166
[00:00:00] –ü–æ–¥—Å—á–µ—Ç –ø–∞—Ä                    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà 15166    /    15166
[00:00:00] –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å–ª–∏—è–Ω–∏–π             ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà 24444    /    24444
üí° –°–æ–≤–µ—Ç: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ litmodels –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –æ–±–ª–∞—á–Ω—ã–º–∏ –∑–∞–≥—Ä—É–∑–∫–∞–º–∏.
GPU –¥–æ—Å—Ç—É–ø–µ–Ω: True (cuda), –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è: True
...
Epoch 2: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 472/472 [00:45<00:00, 10.34it/s, v_num=4, train_loss=6.320]
`Trainer.fit` –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–æ `max_epochs=3`.
```

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞
–ó–∞–ø—É—Å—Ç–∏—Ç–µ `generate.py`:
```
PS C:\Users\79022\Desktop\SummerParty\homework6> & C:/Users/79022/Desktop/SummerParty/homework6/env/Scripts/python.exe c:/Users/79022/Desktop/SummerParty/homework6/generate.py
–í–≤–µ–¥–∏—Ç–µ 'quit' –¥–ª—è –≤—ã—Ö–æ–¥–∞.
–í—ã: –ì–∞—Ä—Ä–∏ –ü–æ—Ç—Ç–µ—Ä?
–ë–æ—Ç (–æ–±—ã—á–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è): –ì–∞—Ä—Ä–∏ –ü–æ—Ç—Ç–µ—Ä? ,? –¥–∏–∫–æ–≤–∞—Ç–æ–≥–æ,, –ù–∏–º–±—É—Å –¥–ª—è –°–Ω—ç–π–ø –ª–∞–∫—Ä–∏—á–Ω—ã–µ:, —á–∞—Å—Ç–æ —Ñ—É—Ç–±–æ–ª—å–Ω—ã–π
 –ì–∞—Ä—Ä–∏ –ò —á—Ç–æ, –Ω–∞–¥:: –≤ –±—ã–ª–∏ –ø–æ–¥ –ø–∞–ª–æ—á–∫—É –ø–æ–ø–∞–ª —á—É–¥–æ–≤–∏—â–Ω–æ–≥–æ –ü–µ—Ç—É–Ω–∏—è. –≤—Å–µ—É—Å–ª—ã—à–∞–Ω–∏–µ
–ë–æ—Ç (beam search): –ì–∞—Ä—Ä–∏ –ü–æ—Ç—Ç–µ—Ä?,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
–í—ã:
```

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- –£–≤–µ–ª–∏—á—å—Ç–µ `num_workers` –≤ `DataLoader` –¥–æ 7 –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ GPU –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –æ–±—É—á–µ–Ω–∏—è.
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `tensorboard` –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ª–æ–≥–æ–≤.

## –í—ã–≤–æ–¥

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–æ–º–∞—à–Ω–µ–π —Ä–∞–±–æ—Ç—ã –±—ã–ª–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ, —á—Ç–æ —Ç–µ–∫—É—â–∞—è –º–æ–¥–µ–ª—å –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤. –û–±—ã—á–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–µ—Ç —Ö–∞–æ—Ç–∏—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å –ª–∏—à–Ω–∏–º–∏ —Å–∏–º–≤–æ–ª–∞–º–∏ ("–ì–∞—Ä—Ä–∏ –ü–æ—Ç—Ç–µ—Ä? ,? –¥–∏–∫–æ–≤–∞—Ç–æ–≥–æ,,..."), –∞ beam search –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤—ã—Ä–æ–∂–¥–∞–µ—Ç—Å—è –≤ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Å–∏–º–≤–æ–ª—ã. –≠—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –¥–æ—Ä–∞–±–æ—Ç–∫–∏ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–∞, —É–≤–µ–ª–∏—á–µ–Ω–∏—è —á–∏—Å–ª–∞ —ç–ø–æ—Ö –æ–±—É—á–µ–Ω–∏—è –¥–æ 10 –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ–¥–µ–ª–∏. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø–∞–ø–∫–µ `results/`. –î–∞–ª—å–Ω–µ–π—à–∞—è —Ä–∞–±–æ—Ç–∞ –¥–æ–ª–∂–Ω–∞ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è –Ω–∞ –ø–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–µ —Ç–µ–∫—Å—Ç–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å –±–æ–ª–µ–µ –¥–ª–∏–Ω–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏.

## –õ–∏—Ü–µ–Ω–∑–∏—è

–†–∞–±–æ—Ç–∞ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT. –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ —Ñ–∞–π–ª–µ `LICENSE`.